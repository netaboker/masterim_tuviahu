<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <title>לוח בקשות חי</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen">

    <nav class="bg-blue-600 p-4 text-white flex justify-center gap-4">
        <button onclick="showPage('welcome-page')" class="hover:underline">בית</button>
        <button onclick="showPage('publish-page')" class="hover:underline">פרסום</button>
        <button onclick="showPage('requests-page')" class="hover:underline">לוח בקשות</button>
    </nav>

    <div id="welcome-page" class="page-section p-10 text-center">
        <h1 class="text-4xl font-bold mb-4">ברוכים הבאים ללוח השיתופי</h1>
        <p class="text-xl">כאן כולם רואים את כולם בזמן אמת!</p>
    </div>

    <div id="publish-page" class="page-section p-8 hidden">
        <div class="max-w-md mx-auto bg-white p-6 rounded shadow-lg">
            <h2 class="text-2xl font-bold mb-4">מה תרצו לפרסם?</h2>
            <form id="request-form" class="space-y-4">
                <input type="text" id="title" placeholder="כותרת" class="w-full border p-2 rounded" required>
                <textarea id="content" placeholder="תוכן הבקשה" class="w-full border p-2 rounded" rows="4" required></textarea>
                <button type="submit" id="submit-btn" class="w-full bg-blue-600 text-white py-2 rounded font-bold">פרסם לכולם</button>
            </form>
        </div>
    </div>

    <div id="requests-page" class="page-section p-8 hidden">
        <h2 class="text-3xl font-bold mb-6 text-center">בקשות מהקהילה</h2>
        <div id="requests-container" class="grid gap-4 max-w-2xl mx-auto">
            <p class="text-center">טוען נתונים מהענן...</p>
        </div>
    </div>

    <script>
        // --- הגדרות ה-FIREBASE שלך ---
        // הדביקי כאן את הכתובת שקיבלת ב-Realtime Database (למשל https://test-default-rtdb.firebaseio.com/)
        const FIREBASE_URL = "כאן_להדביק_את_הקישור_שלך/posts.json";

        function showPage(pageId) {
            document.querySelectorAll('.page-section').forEach(p => p.classList.add('hidden'));
            document.getElementById(pageId).classList.remove('hidden');
            if (pageId === 'requests-page') loadFromCloud();
        }

        // חזרה לבית בריענון
        window.onload = () => showPage('welcome-page');

        // שליחה לענן
        document.getElementById('request-form').onsubmit = async (e) => {
            e.preventDefault();
            const btn = document.getElementById('submit-btn');
            btn.disabled = true;

            const data = {
                title: document.getElementById('title').value,
                content: document.getElementById('content').value,
                timestamp: new Date().toISOString()
            };

            try {
                await fetch(FIREBASE_URL, {
                    method: 'POST',
                    body: JSON.stringify(data)
                });
                alert("פורסם בהצלחה!");
                document.getElementById('request-form').reset();
                showPage('requests-page');
            } catch (err) {
                alert("שגיאה בחיבור לענן");
            } finally {
                btn.disabled = false;
            }
        };

        // משיכה מהענן - כולם רואים את כולם!
        async function loadFromCloud() {
            const container = document.getElementById('requests-container');
            try {
                const response = await fetch(FIREBASE_URL);
                const allData = await response.json();
                
                if (!allData) {
                    container.innerHTML = "<p class='text-center'>עוד אין בקשות בלוח.</p>";
                    return;
                }

                container.innerHTML = Object.values(allData).reverse().map(item => `
                    <div class="bg-white p-4 rounded shadow border-r-4 border-blue-500 text-right">
                        <h3 class="font-bold text-lg">${item.title}</h3>
                        <p class="text-gray-600">${item.content}</p>
                        <small class="text-gray-400">${new Date(item.timestamp).toLocaleString('he-IL')}</small>
                    </div>
                `).join('');
            } catch (err) {
                container.innerHTML = "שגיאה בטעינת הנתונים.";
            }
        }
    </script>
</body>
</html>
