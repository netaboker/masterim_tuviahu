<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>×”×××¡×˜×¨×™× ×©×œ ×˜×•×‘×™×”×• - ×’×¨×¡×” ×¡×•×¤×™×ª</title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4f46e5; --secondary: #ec4899; --dark: #0f172a;
            --bg: #f1f5f9; --success: #10b981; --warning: #f59e0b; --danger: #ef4444;
        }
        body { font-family: 'Assistant', sans-serif; margin: 0; background: var(--bg); color: var(--dark); padding-bottom: 80px; }
        
        header { background: white; padding: 12px 25px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.05); position: sticky; top: 0; z-index: 1000; }
        .logo { display: flex; align-items: center; gap: 10px; font-weight: 800; font-size: 1.3rem; color: var(--dark); cursor: pointer; }
        .logo-box { background: var(--primary); color: white; width: 35px; height: 35px; border-radius: 8px; display: flex; align-items: center; justify-content: center; }
        
        .user-nav { display: flex; align-items: center; gap: 12px; }
        .avatar-circle { width: 35px; height: 35px; border-radius: 50%; background: var(--secondary); color: white; display: flex; align-items: center; justify-content: center; font-weight: 700; cursor: pointer; }

        nav { background: white; display: flex; gap: 8px; padding: 10px 25px; border-bottom: 1px solid #e2e8f0; overflow-x: auto; }
        nav a { text-decoration: none; color: #64748b; font-weight: 600; padding: 8px 16px; border-radius: 50px; background: #f8fafc; border: 1px solid #e2e8f0; white-space: nowrap; cursor: pointer; }
        nav a.active { background: var(--primary); color: white; border-color: var(--primary); }

        .container { max-width: 1100px; margin: 20px auto; padding: 0 20px; }
        .page { display: none; }
        .page.active { display: block; }

        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .card { background: white; border-radius: 20px; padding: 20px; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); border: 1px solid #fff; }
        
        .status-tag { display: inline-block; padding: 3px 10px; border-radius: 50px; font-size: 0.75rem; font-weight: 700; margin-bottom: 10px; }
        .status-open { background: #dcfce7; color: #166534; }
        .status-work { background: #fef9c3; color: #854d0e; }
        
        .btn { width: 100%; padding: 12px; border: none; border-radius: 12px; font-weight: 700; cursor: pointer; margin-top: 10px; font-family: inherit; }
        .btn-primary { background: var(--primary); color: white; }
        .btn-secondary { background: var(--secondary); color: white; }

        .form-box { background: white; padding: 25px; border-radius: 20px; max-width: 500px; margin: 0 auto; }
        label { display: block; font-weight: 700; margin-top: 15px; margin-bottom: 5px; }
        input, select, textarea { width: 100%; padding: 12px; border: 2px solid #f1f5f9; border-radius: 10px; box-sizing: border-box; font-family: inherit; }

        #login-screen { height: 100vh; display: flex; align-items: center; justify-content: center; background: var(--primary); position: fixed; inset: 0; z-index: 9999; }
    </style>
</head>
<body onload="initSystem()">

    <section id="login-screen">
        <div style="background: white; padding: 40px; border-radius: 30px; text-align: center; width: 90%; max-width: 380px;">
            <h1 style="margin-bottom: 20px;">×”×××¡×˜×¨×™× ×©×œ ×˜×•×‘×™×”×•</h1>
            <input type="text" id="loginName" placeholder="×”×›× ×¡ ×©× ××œ×">
            <button class="btn btn-primary" onclick="handleLogin()">×›× ×™×¡×”</button>
        </div>
    </section>

    <div id="app" style="display:none">
        <header>
            <div class="logo" onclick="showPage('dash')">
                <div class="logo-box">M</div>
                <span>×”×××¡×˜×¨×™× ×©×œ ×˜×•×‘×™×”×•</span>
            </div>
            <div class="user-nav">
                <span id="header-points" style="font-weight: 800; color: var(--primary);">ğŸ’ 0</span>
                <div class="avatar-circle" id="user-avatar" onclick="showPage('profile')">?</div>
            </div>
        </header>

        <nav>
            <a id="nav-dash" onclick="showPage('dash')" class="active">×œ×•×— ×‘×§×©×•×ª ğŸ¤</a>
            <a id="nav-new" onclick="showPage('new')">×‘×§×©×” ×—×“×©×” +</a>
            <a id="nav-experts" onclick="showPage('experts')">× ×‘×—×¨×ª ×”××•××—×™× ğŸ“</a>
            <a id="nav-admin" onclick="showPage('admin')" style="color:var(--danger)">× ×™×”×•×œ ğŸ› ï¸</a>
        </nav>

        <div class="container">
            <div id="page-dash" class="page active">
                <h2>×¢×–×¨×” ×“×¨×•×©×”</h2>
                <div id="grid-requests" class="grid"></div>
            </div>

            <div id="page-new" class="page">
                <div class="form-box">
                    <h2>×¤×¨×¡×•× ×‘×§×©×ª ×¢×–×¨×”</h2>
                    <label>××” ×”×¦×•×¨×š ×©×œ×š?</label>
                    <input type="text" id="req-title" placeholder="×œ××©×œ: ×¢×–×¨×” ×‘××ª××˜×™×§×”">
                    <label>×ª×™××•×¨ ×§×¦×¨</label>
                    <textarea id="req-desc" rows="3" placeholder="×¤×¨×˜ ×§×¦×ª ×™×•×ª×¨..."></textarea>
                    <button class="btn btn-primary" onclick="addRequest()">×¤×¨×¡× ×¢×›×©×™×•</button>
                </div>
            </div>

            <div id="page-experts" class="page">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <h2>× ×‘×—×¨×ª ×”××•××—×™×</h2>
                    <button class="btn btn-secondary" style="width:auto; margin:0;" onclick="showPage('expert-join')">×”×¦×˜×¨×¤×•×ª</button>
                </div>
                <div id="grid-experts" class="grid" style="margin-top:20px;"></div>
            </div>

            <div id="page-expert-join" class="page">
                <div class="form-box">
                    <h2>×”×¦×˜×¨×¤×•×ª ×œ××•××—×™×</h2>
                    <label>×‘××” ××ª×” ××•××—×”?</label>
                    <input type="text" id="exp-skill" placeholder="×œ××©×œ: ×¢×™×¦×•×‘ ×‘×§× ×‘×”">
                    <label>×¡×¤×¨ ×¢×œ ×”×™×›×•×œ×•×ª ×©×œ×š</label>
                    <textarea id="exp-desc" rows="3" placeholder="××” ×ª×•×›×œ ×œ×¢×©×•×ª ×¢×‘×•×¨ ××—×¨×™×?"></textarea>
                    <button class="btn btn-secondary" onclick="addExpert()">×¤×¨×¡× ×¢×›×©×™×•</button>
                </div>
            </div>

            <div id="page-admin" class="page"><h2>×¤×× ×œ × ×™×”×•×œ</h2><div id="admin-list" class="grid"></div></div>
            <div id="page-profile" class="page"><h2>×”×¤×¨×•×¤×™×œ ×©×œ×™</h2><div id="user-info"></div></div>
        </div>
    </div>

    <script>
        let db = {
            user: { name: "", points: 0 },
            requests: [],
            experts: []
        };

        function initSystem() {
            // ×˜×¢×™× ×” ××”×–×™×›×¨×•×Ÿ
            const saved = localStorage.getItem('TOVIYAHU_FINAL_DATA');
            if (saved) db = JSON.parse(saved);

            // ×‘×“×™×§×ª ×”×ª×—×‘×¨×•×ª
            if (db.user.name) {
                loginSuccess();
            }

            // ×¤×ª×¨×•×Ÿ ×œ×¨×¢× ×•×Ÿ ×¢××•×“: ×—×–×¨×” ×œ×“×©×‘×•×¨×“ ×ª××™×“
            showPage('dash');
            renderUI();
        }

        function save() {
            localStorage.setItem('TOVIYAHU_FINAL_DATA', JSON.stringify(db));
            renderUI();
        }

        function handleLogin() {
            const name = document.getElementById('loginName').value;
            if (!name) return alert("× × ×œ×”×–×™×Ÿ ×©×");
            db.user.name = name;
            save();
            loginSuccess();
        }

        function loginSuccess() {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('app').style.display = 'block';
        }

        function showPage(id) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('nav a').forEach(a => a.classList.remove('active'));
            
            document.getElementById('page-' + id).classList.add('active');
            if(document.getElementById('nav-' + id)) document.getElementById('nav-' + id).classList.add('active');
        }

        // --- ×¤×•× ×§×¦×™×•×ª ×”×¤×¨×¡×•× ×”××‘×•×§×©×•×ª ---

        function addRequest() {
            const title = document.getElementById('req-title').value;
            const desc = document.getElementById('req-desc').value;

            if (!title || !desc) return alert("× × ×œ××œ× ××ª ×›×œ ×”×©×“×•×ª");

            const newReq = {
                id: Date.now(),
                creator: db.user.name,
                title: title,
                desc: desc,
                status: 'open'
            };

            db.requests.unshift(newReq); // ×”×•×¡×¤×” ×œ×¨××© ×”×¨×©×™××”
            save();

            // × ×™×§×•×™ ×˜×•×¤×¡ ×•××¢×‘×¨ ×œ×œ×•×—
            document.getElementById('req-title').value = "";
            document.getElementById('req-desc').value = "";
            alert("×”×‘×§×©×” ×¤×•×¨×¡××” ×‘×”×¦×œ×—×”!");
            showPage('dash');
        }

        function addExpert() {
            const skill = document.getElementById('exp-skill').value;
            const desc = document.getElementById('exp-desc').value;

            if (!skill || !desc) return alert("× × ×œ××œ× ××ª ×›×œ ×”×©×“×•×ª");

            const newExpert = {
                id: Date.now(),
                name: db.user.name,
                skill: skill,
                desc: desc
            };

            db.experts.unshift(newExpert);
            save();

            // × ×™×§×•×™ ×˜×•×¤×¡ ×•××¢×‘×¨ ×œ×œ×•×—
            document.getElementById('exp-skill').value = "";
            document.getElementById('exp-desc').value = "";
            alert("× ×•×¡×¤×ª ×œ× ×‘×—×¨×ª ×”××•××—×™×!");
            showPage('experts');
        }

        // --- ×¨×™× ×“×•×¨ ×”× ×ª×•× ×™× ×¢×œ ×”××¡×š ---

        function renderUI() {
            document.getElementById('header-points').innerText = 'ğŸ’ ' + db.user.points;
            document.getElementById('user-avatar').innerText = db.user.name ? db.user.name[0] : "?";

            // ×¨×™× ×“×•×¨ ×œ×•×— ×‘×§×©×•×ª
            const reqGrid = document.getElementById('grid-requests');
            reqGrid.innerHTML = db.requests.map(r => `
                <div class="card">
                    <span class="status-tag status-open">â— ×¤×ª×•×—</span>
                    <h3>${r.title}</h3>
                    <p>${r.desc}</p>
                    <small>×¤×•×¨×¡× ×¢"×™: ${r.creator}</small>
                </div>
            `).join('') || "<p>××™×Ÿ ×‘×§×©×•×ª ×›×¨×’×¢...</p>";

            // ×¨×™× ×“×•×¨ ×œ×•×— ××•××—×™×
            const expGrid = document.getElementById('grid-experts');
            expGrid.innerHTML = db.experts.map(e => `
                <div class="card" style="border-top: 5px solid var(--secondary)">
                    <h3>${e.skill}</h3>
                    <p>${e.desc}</p>
                    <small>×”×××¡×˜×¨: ${e.name}</small>
                    <button class="btn btn-secondary">×¤× ×™×™×” ×œ××•××—×”</button>
                </div>
            `).join('') || "<p>× ×‘×—×¨×ª ×”××•××—×™× ××ª×’×‘×©×ª...</p>";
        }
    </script>
</body>
</html>
